import{s as k,af as j,r as w,M as R,o as p,ar as z,b as d,t as q,a,w as t,F as Z,e as D,B as y,A as h,c,f as g}from"./index.cf0c9c6f.js";import{V as E,a as I,b as L,c as J}from"./VCard.f6146da5.js";import{V as K}from"./VToolbar.8cbd8721.js";import{V as O,a as m}from"./VTextField.6ebe472d.js";import{V as i}from"./VCol.f2816318.js";import{V as Q}from"./VSheet.27bb7db6.js";import{V}from"./VSelect.65acbb18.js";import{V as W,a as X}from"./VSpacer.fe6ef003.js";import{V as Y}from"./VBtn.f9a25fce.js";import"./VAvatar.5ba3f4fb.js";import"./color.d0331193.js";import"./index.ad027877.js";import"./VList.b3f86eb0.js";import"./VDivider.6dc731e0.js";import"./group.f608004d.js";const ee={class:"row"},le={class:"row"},oe={class:"row"},ae={class:"row"},te={class:"row"},se={class:"row"},ie={class:"row"},re={class:"row"},ne={class:"row"},de={class:"text-center"},xe={__name:"PaymentCreate",setup(me){const A=k.employeeStore(),G=k.clientStore(),H=k.serviceStore(),$=k.paymentStore();j(function(){Promise.all([A.loadEmployees(),G.loadClients(),H.loadServices()]).then(function(r){}).catch(function(r){})});const n=w({strings:r=>!!(r||"").match("^[a-z A-Z s]+$")||"Por favor, informe apenas letras.",numbers:r=>!!(r||"").match("^[0-9 .]+$")||"Por favor, informe apenas n\xFAmeros.",required:r=>!!r||"Este campo \xE9 mandat\xF3rio.",form:!1,isLoading:!1,dialog:!1});let _=R("none");const s=w({}),o=w({client:void 0,reportedAt:void 0,employee:void 0,employee_car_efficiency:void 0,employee_discounts:void 0,employee_discounts_description:void 0,employee_gains:void 0,employee_gas_price:void 0,employee_miles_travelled:void 0,employee_salary_hours:void 0,employee_service_percentage:void 0,employee_tips:void 0,employee_work_hours:void 0,employer_gains:void 0,service:void 0,service_billing:void 0,reportedAt:void 0,status:!0}),M=w({employeeGains(){let r=o.employee_work_hours,l=o.employee_salary_hours,e=parseFloat(r*l)||0,b=o.service_billing,C=o.employee_service_percentage,F=parseFloat(b*C)||0,P=o.employee_miles_travelled,x=o.employee_car_efficiency,U=o.employee_gas_price,S=parseFloat(P/x*U)||0,T=parseFloat(o.employee_tips)||0,B=parseFloat(o.employee_discounts)||0,v=e+F+S+T-B||0;return v=parseFloat(v).toFixed(2),s.employee_gains=v,o.employee_gains=v,v},companyGains(){let r=o.employee_work_hours,l=o.employee_salary_hours,e=parseFloat(r*l)||0,b=parseFloat(o.service_billing)||0,C=o.employee_service_percentage,F=parseFloat(b*C)||0,P=o.employee_miles_travelled,x=o.employee_car_efficiency,U=o.employee_gas_price,S=parseFloat(P/x*U)||0,T=parseFloat(o.employee_discounts)||0,f=b-(e+F+S-T)||0;return f=parseFloat(f).toFixed(2),s.employer_gains=f,o.employer_gains=f,f}});function u(){o.reportedAt&&o.client&&o.employee&&o.service&&o.service_billing&&(o.employee_salary_hours&&o.employee_work_hours||o.employee_service_percentage)&&(n.form=!0)}function N(){n.isLoading=!0,$.savePayments(o,s).then(function(r){n.output="Pagamento salvo com sucesso!",n.dialog=!0}).catch(function(r){n.output="Pagamento n\xE3o pode ser salvo! Tente novamente mais tarde.",n.dialog=!0}).finally(function(){n.isLoading=!1,this.reset(),n.form=!1})}return(r,l)=>(p(),z(Z,null,[d("div",null,q(s),1),d("div",null,q(o),1),a(E,{class:"mx-auto"},{default:t(()=>[a(K,{color:"",cards:"",dark:"",flat:""},{default:t(()=>[a(I,{class:"text-h6 font-weight-regular"},{default:t(()=>[D(" Cadastro de Pagamentos ")]),_:1})]),_:1}),a(O,{ref:"form","lazy-validation":"",class:"pa-4 pt-6"},{default:t(()=>[d("div",ee,[a(i,{cols:"6",offset:"3"},{default:t(()=>[a(Q)]),_:1}),a(i,{cols:"3"},{default:t(()=>[a(m,{label:"Refer\xEAncia",type:"date",required:"",modelValue:o.reportedAt,"onUpdate:modelValue":[l[0]||(l[0]=e=>o.reportedAt=e),l[1]||(l[1]=e=>(s.date=e,u()))]},null,8,["modelValue"])]),_:1})]),d("div",le,[a(i,{cols:"6"},{default:t(()=>[a(V,{hint:"Colaborador quem receber\xE1 o pagamento.",items:y(A).nameEmployees,"item-title":"name","item-value":"id",label:"Colaborador","onUpdate:modelValue":l[2]||(l[2]=e=>(o.employee=e.id,u(),s.employee=e.name)),"persistent-hint":"","return-object":"","single-line":""},null,8,["hint","items"])]),_:1}),a(i,{cols:"6"},{default:t(()=>[a(V,{hint:"Cliente para quem foi prestado servi\xE7o.",items:y(G).nameClients,"item-title":"name","item-value":"id",label:"Cliente","onUpdate:modelValue":l[3]||(l[3]=e=>(o.client=e.id,o.service_billing=e.total_revenue,u(),s.client=e.name,s.service_billing=e.total_revenue)),"persistent-hint":"","return-object":"","single-line":""},null,8,["hint","items"])]),_:1})]),d("div",oe,[a(i,{cols:"6"},{default:t(()=>[a(V,{hint:"Servi\xE7o prestado ao cliente.",items:y(H).nameServices,"item-title":"name","item-value":"id",label:"Servi\xE7o","onUpdate:modelValue":l[4]||(l[4]=e=>(o.service=e.id,u(),s.service=e.name)),"persistent-hint":"","return-object":"","single-line":"",required:""},null,8,["hint","items"])]),_:1}),a(i,{cols:"6"},{default:t(()=>[a(m,{modelValue:o.service_billing,"onUpdate:modelValue":[l[5]||(l[5]=e=>o.service_billing=e),l[6]||(l[6]=e=>(u(),s.service_billing=e))],prefix:"$",label:"Fatura",required:""},null,8,["modelValue"])]),_:1})]),d("div",ae,[a(i,{cols:"12"},{default:t(()=>[a(V,{modelValue:r.select,"onUpdate:modelValue":[l[7]||(l[7]=e=>r.select=e),l[8]||(l[8]=e=>(h(_)?_.value=e:_=e,u(),o.employee_service_percentage=void 0,o.employee_work_hours=void 0,o.employee_salary_hours=void 0,s.employee_service_percentage=void 0,s.employee_work_hours=void 0,s.employee_salary_hours=void 0))],items:["Porcentagem de Participa\xE7\xE3o","Horas Trabalhadas"],label:"M\xE9todo de Pagamanto",required:""},null,8,["modelValue"])]),_:1})]),d("div",te,[y(_)==="Horas Trabalhadas"?(p(),c(i,{key:0,cols:"6"},{default:t(()=>[a(m,{modelValue:o.employee_work_hours,"onUpdate:modelValue":[l[9]||(l[9]=e=>o.employee_work_hours=e),l[10]||(l[10]=e=>(u(),s.employee_work_hours=e))],label:"Horas Trabalhadas",required:"",suffix:"H"},null,8,["modelValue"])]),_:1})):g("",!0),y(_)==="Horas Trabalhadas"?(p(),c(i,{key:1,cols:"6"},{default:t(()=>[a(m,{modelValue:o.employee_salary_hours,"onUpdate:modelValue":[l[11]||(l[11]=e=>o.employee_salary_hours=e),l[12]||(l[12]=e=>(u(),s.employee_salary_hours=e))],label:"Sal\xE1rio Hora",required:"",prefix:"$"},null,8,["modelValue"])]),_:1})):g("",!0),y(_)==="Porcentagem de Participa\xE7\xE3o"?(p(),c(i,{key:2,cols:"6"},{default:t(()=>[a(V,{modelValue:o.employee_service_percentage,"onUpdate:modelValue":[l[13]||(l[13]=e=>o.employee_service_percentage=e),l[14]||(l[14]=e=>(u(),s.employee_service_percentage=e))],items:[{label:"25%",value:.25},{label:"27%",value:.27},{label:"37%",value:.37},{label:"75%",value:.75}],label:"Porcentagem de Participa\xE7\xE3o","item-title":"label",required:""},null,8,["modelValue","items"])]),_:1})):g("",!0)]),d("div",se,[a(i,{cols:"6"},{default:t(()=>[a(m,{modelValue:o.employee_tips,"onUpdate:modelValue":[l[15]||(l[15]=e=>o.employee_tips=e),l[16]||(l[16]=e=>s.employee_tips=e)],label:"Tips",prefix:"$"},null,8,["modelValue"])]),_:1})]),d("div",ie,[a(i,{cols:"6"},{default:t(()=>[a(m,{modelValue:o.employee_discounts,"onUpdate:modelValue":[l[17]||(l[17]=e=>o.employee_discounts=e),l[18]||(l[18]=e=>s.employee_discounts=e)],prefix:"$",label:"Desconto"},null,8,["modelValue"])]),_:1}),o.employee_discounts?(p(),c(i,{key:0,cols:"6"},{default:t(()=>[a(m,{modelValue:o.employee_discounts_description,"onUpdate:modelValue":[l[19]||(l[19]=e=>o.employee_discounts_description=e),l[20]||(l[20]=e=>s.employee_discounts_description=e)],label:"Descri\xE7\xE3o de Desconto"},null,8,["modelValue"])]),_:1})):g("",!0)]),d("div",re,[a(i,{cols:"4"},{default:t(()=>[a(m,{modelValue:o.employee_miles_travelled,"onUpdate:modelValue":[l[21]||(l[21]=e=>o.employee_miles_travelled=e),l[22]||(l[22]=e=>s.employee_miles_travelled=e)],label:"Milhas",suffix:"MPG"},null,8,["modelValue"])]),_:1}),o.employee_miles_travelled?(p(),c(i,{key:0,cols:"4"},{default:t(()=>[a(m,{modelValue:o.employee_car_efficiency,"onUpdate:modelValue":[l[23]||(l[23]=e=>o.employee_car_efficiency=e),l[24]||(l[24]=e=>s.employee_car_efficiency=e)],label:"Autonomia",suffix:"MPL"},null,8,["modelValue"])]),_:1})):g("",!0),o.employee_miles_travelled?(p(),c(i,{key:1,cols:"4"},{default:t(()=>[a(m,{modelValue:o.employee_gas_price,"onUpdate:modelValue":[l[25]||(l[25]=e=>o.employee_gas_price=e),l[26]||(l[26]=e=>s.employee_gas_price=e)],label:"Pre\xE7o Combust\xEDvel",prefix:"$"},null,8,["modelValue"])]),_:1})):g("",!0)]),d("div",ne,[a(i,{cols:"6"},{default:t(()=>[a(m,{variant:"underlined","model-value":"$"+M.employeeGains(),label:"Ganhos do Colaborador",disabled:""},null,8,["model-value"])]),_:1}),a(i,{cols:"6"},{default:t(()=>[a(m,{variant:"underlined","model-value":"$"+M.companyGains(),label:"Ganhos da Companhia",disabled:""},null,8,["model-value"])]),_:1})])]),_:1},512),a(L,null,{default:t(()=>[a(W),a(Y,{disabled:!n.form,loading:n.isLoading,color:"primary",onClick:l[27]||(l[27]=e=>N())},{default:t(()=>[D(" Salvar ")]),_:1},8,["disabled","loading"])]),_:1}),d("div",de,[a(X,{modelValue:n.dialog,"onUpdate:modelValue":l[29]||(l[29]=e=>n.dialog=e),activator:"parent",type:"error"},{default:t(()=>[a(E,null,{default:t(()=>[a(J,null,{default:t(()=>[d("span",null,q(n.output),1)]),_:1}),a(L,{class:"d-grid"},{default:t(()=>[d("button",{type:"button",class:"btn btn-primary block",onClick:l[28]||(l[28]=e=>n.dialog=!1)}," FECHAR ")]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})],64))}};export{xe as default};
